<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Badminton Club Manager</title>
    <meta name="theme-color" content="#3B82F6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Badminton Club">
    
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiQmFkbWludG9uIENsdWIgTWFuYWdlciIsInNob3J0X25hbWUiOiJCYWRtaW50b25DbHViIiwiZGVzY3JpcHRpb24iOiJTbWFydCBnYW1lIHBhaXJpbmcgYW5kIHBsYXllciBtYW5hZ2VtZW50IGZvciBiYWRtaW50b24gY2x1YnMiLCJzdGFydF91cmwiOiIvIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiI2ZmZmZmZiIsInRoZW1lX2NvbG9yIjoiIzNCODJGNiIsIm9yaWVudGF0aW9uIjoicG9ydHJhaXQtcHJpbWFyeSIsImljb25zIjpbeyJzcmMiOiJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlNVGt5SWlCb1pXbG5hSFE5SWpFNU1pSWdkbWxsZDBKdmVEMGlNQ0F3SURFNU1pQXhPVElpSUdacGJHdzlJbTV2Ym1VaUlIaHRiRzV6UFNKb2RIUndPaTh2ZDNkM0xuY3pMbTl5Wnk4eU1EQXdMM04yWnlJK0NqeHlaV04wSUhkcFpIUm9QU0l4T1RJaUlHaGxhV2RvZEQwaU1Ua3lJaUJ5ZUQwaU1qUWlJR1pwYkd3OUlpTXpRamcwUmpZaUx6NEtQSE4yWnlCNFBTSTBPQ0lnZVQwaU5EZ2lJSGRwWkhSb1BTSTVOaUlnYUdWcFoyaDBQU0k1TmlJZ2RtbGxkMEp2ZUQwaU1DQXdJREkwSURJMElpQm1hV3hzUFNKdWIyNWxJaUJ6ZEhKdmEyVTlJbmRvYVhSbElpQnpkSEp2YTJVdGQybGtkR2c5SWpJaUlITjBjbTlyWlMxc2FXNWxZMkZ3UFNKeWIzVnVaQ0lnYzNSeWIydGxMV3hwYm1WcWIybHVQU0p5YjNWdVpDSStDanh3WVhSb0lHUTlJbTE0SUROa01UQWdOaUEySUNBMklDMDJJaThLUEhCaGRHZ2daRDBpYlRZZ01Ua2dOaUEySUNBMklEWXROaUl2UGdvOGMzWm5JSGc5SWpNaUlIazlJak1pSUhkcFpIUm9QU0l4T0NJZ2FHVnBaMmgwUFNJeE9DSWdkbWxsZDBKdmVEMGlNQ0F3SURJMElESTBJaUJtYVd4c1BTSnViMjVsSWlCemRISnZhMlU5SW1OMWNuSmxiblJEYjJ4dmNpSWdjM1J5YjJ0bExYZHBaSFJvUFNJeUlpQnpkSEp2YTJVdGJHbHVaV05oY0QwaWNtOTFibVFpSUhOMGNtOXJaUzFzYVc1bGFtOXBiajBpY205MWJtUWlQZ29yY0dGMGFDQmtQU0p0Tml3NUlEWWdOaUEySUNBMklDMDJJaThLUEhCaGRHZ2daRDBpYlRZZ09TQTJJRFlnTmlBMklDMDJJaThLUEM5emRtYytDand2YzNabkNqd3ZjM1puUGdvPSIsInNpemVzIjoiMTkyeDE5MiIsInR5cGUiOiJpbWFnZS9zdmcreG1sIn0seyJzcmMiOiJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlOVEV5SWlCb1pXbG5hSFE5SWpVeE1pSWdkbWxsZDBKdmVEMGlNQ0F3SURVeE1pQTFNVElpSUdacGJHdzlJbTV2Ym1VaUlIaHRiRzV6UFNKb2RIUndPaTh2ZDNkM0xuY3pMbTl5Wnk4eU1EQXdMM04yWnlJK0NqeHlaV04wSUhkcFpIUm9QU0kxTVRJaUlHaGxhV2RvZEQwaU5URXlJaUJ5ZUQwaU5qUWlJR1pwYkd3OUlpTXpRamcwUmpZaUx6NEtQSE4yWnlCNFBTSXhNamdpSUhrOUlqRXlPQ0lnZDJsa2RHZzlJakkxTmlJZ2FHVnBaMmgwUFNJeU5UWWlJSFpwWlhkQ2IzZzlJakFnTUNBeU5DQXlOQ0lnWm1sc2JEMGlibTl1WlNJZ2MzUnliMnRsUFNKM2FHbDBaU0lnYzNSeWIydGxMWGRwWkhSb1BTSXlJaUJ6ZEhKdmEyVXRiR2x1WldOaGNEMGljbTkxYm1RaUlITjBjbTlyWlMxc2FXNWxhbTlwYmowaWNtOTFibVFpUGdvOGNHRjBhQ0JrUFNKdE5pQTVJRFlnTmlBMklEWXROaUl2UGdvOGMzWm5JSGc5SWpnaUlIazlJamdpSUhkcFpIUm9QU0k0SWlCb1pXbG5hSFE5SWpnaUlIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSWdabWxzYkQwaWJtOXVaU0lnYzNSeWIydGxQU0pqZFhKeVpXNTBRMjlzYjNJaUlITjBjbTlyWlMxM2FXUjBhRDBpTWlJZ2MzUnliMnRsTFd4cGJtVmpZWEE5SW5KdmRXNWtJaUJ6ZEhKdmEyVXRiR2x1WldwdmFXNDlJbkp2ZFc1a0lqNEtQSEJoZEdnZ1pEMGliVFlnT1NBMklEWWdOaUEySUMwMklpOEtQQzl6ZG1jS1BDOXpkbWMrQ2p3dmMzWm5QZ289Iiwic2l6ZXMiOiI1MTJ4NTEyIiwidHlwZSI6ImltYWdlL3N2Zyt4bWwifV19">
    
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { 
            margin: 0; 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #EBF8FF 0%, #FFFFFF 50%, #F0FDF4 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const BadmintonClubManager = () => {
            // State management
            const [players, setPlayers] = React.useState([]);
            const [activeGames, setActiveGames] = React.useState([]);
            const [gameHistory, setGameHistory] = React.useState([]);
            const [clubNights, setClubNights] = React.useState([]);
            const [currentClubNight, setCurrentClubNight] = React.useState(null);
            const [attendingPlayers, setAttendingPlayers] = React.useState([]);
            const [courtsInUse, setCourtsInUse] = React.useState(4);
            const [currentView, setCurrentView] = React.useState('dashboard');
            const [newPlayer, setNewPlayer] = React.useState({ name: '', gender: 'male', skillLevel: 5 });
            const [deferredPrompt, setDeferredPrompt] = React.useState(null);
            const [showInstallPrompt, setShowInstallPrompt] = React.useState(false);

            // PWA functionality
            React.useEffect(() => {
                const handleBeforeInstallPrompt = (e) => {
                    e.preventDefault();
                    setDeferredPrompt(e);
                    setShowInstallPrompt(true);
                };

                window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

                if (window.matchMedia('(display-mode: standalone)').matches) {
                    setShowInstallPrompt(false);
                } else {
                    setTimeout(() => setShowInstallPrompt(true), 3000);
                }

                return () => {
                    window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
                };
            }, []);

            const handleInstallClick = async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    setDeferredPrompt(null);
                }
                setShowInstallPrompt(false);
            };

            // Initialize sample data
            React.useEffect(() => {
                const savedData = localStorage.getItem('badmintonClubData');
                if (savedData) {
                    try {
                        const data = JSON.parse(savedData);
                        if (data.players) setPlayers(data.players);
                        if (data.gameHistory) setGameHistory(data.gameHistory);
                        if (data.clubNights) setClubNights(data.clubNights);
                        if (data.currentClubNight) setCurrentClubNight(data.currentClubNight);
                        if (data.attendingPlayers) setAttendingPlayers(data.attendingPlayers);
                    } catch (error) {
                        console.error('Error loading saved data:', error);
                    }
                } else {
                    // Initialize with sample data
                    const samplePlayers = [
                        { id: 1, name: 'Alex Chen', gender: 'male', skillLevel: 7, gamesPlayed: 12, wins: 8, rating: 1650 },
                        { id: 2, name: 'Sarah Wilson', gender: 'female', skillLevel: 6, gamesPlayed: 10, wins: 6, rating: 1580 },
                        { id: 3, name: 'Mike Johnson', gender: 'male', skillLevel: 8, gamesPlayed: 15, wins: 12, rating: 1720 },
                        { id: 4, name: 'Emma Davis', gender: 'female', skillLevel: 5, gamesPlayed: 8, wins: 4, rating: 1420 },
                        { id: 5, name: 'Tom Brown', gender: 'male', skillLevel: 6, gamesPlayed: 11, wins: 7, rating: 1590 },
                        { id: 6, name: 'Lisa Zhang', gender: 'female', skillLevel: 7, gamesPlayed: 9, wins: 6, rating: 1610 },
                        { id: 7, name: 'James Wilson', gender: 'male', skillLevel: 5, gamesPlayed: 7, wins: 3, rating: 1480 },
                        { id: 8, name: 'Anna Smith', gender: 'female', skillLevel: 6, gamesPlayed: 9, wins: 5, rating: 1520 }
                    ];
                    
                    const pastClubNights = [
                        { 
                            id: 1, 
                            date: '2025-06-24', 
                            status: 'completed',
                            attendees: [1, 2, 3, 4, 5, 6],
                            totalGames: 8,
                            totalShuttles: 12
                        }
                    ];
                    
                    setPlayers(samplePlayers);
                    setClubNights(pastClubNights);
                }
            }, []);

            // Save data to localStorage
            React.useEffect(() => {
                const dataToSave = {
                    players,
                    gameHistory,
                    clubNights,
                    currentClubNight,
                    attendingPlayers
                };
                localStorage.setItem('badmintonClubData', JSON.stringify(dataToSave));
            }, [players, gameHistory, clubNights, currentClubNight, attendingPlayers]);

            // Core functions
            const startNewClubNight = () => {
                const today = new Date();
                const newClubNight = {
                    id: Date.now(),
                    date: today.toISOString().split('T')[0],
                    status: 'active',
                    attendees: [],
                    totalGames: 0
                };
                
                setClubNights([...clubNights, newClubNight]);
                setCurrentClubNight(newClubNight);
                setAttendingPlayers([]);
                setActiveGames([]);
            };

            const togglePlayerAttendance = (playerId) => {
                if (attendingPlayers.includes(playerId)) {
                    setAttendingPlayers(attendingPlayers.filter(id => id !== playerId));
                } else {
                    setAttendingPlayers([...attendingPlayers, playerId]);
                }
            };

            const finishClubNight = () => {
                if (currentClubNight) {
                    const nightGames = gameHistory.filter(game => game.clubNightId === currentClubNight.id);
                    const totalShuttles = nightGames.reduce((total, game) => total + (game.shuttlesUsed || 0), 0);
                    
                    const updatedClubNight = {
                        ...currentClubNight,
                        status: 'completed',
                        attendees: attendingPlayers,
                        totalGames: nightGames.length,
                        totalShuttles: totalShuttles
                    };
                    
                    setClubNights(clubNights.map(cn => 
                        cn.id === currentClubNight.id ? updatedClubNight : cn
                    ));
                    setCurrentClubNight(null);
                    setAttendingPlayers([]);
                    setActiveGames([]);
                }
            };

            const addPlayer = () => {
                if (newPlayer.name.trim()) {
                    const player = {
                        id: Date.now(),
                        ...newPlayer,
                        gamesPlayed: 0,
                        wins: 0,
                        rating: 1500
                    };
                    setPlayers([...players, player]);
                    setNewPlayer({ name: '', gender: 'male', skillLevel: 5 });
                }
            };

            const generateBalancedPairings = () => {
                if (!currentClubNight) return;
                
                const availablePlayers = players.filter(p => 
                    attendingPlayers.includes(p.id) &&
                    !activeGames.some(game => 
                        game.players.some(player => player.id === p.id)
                    )
                );

                if (availablePlayers.length < 4) return;

                const pairings = [];
                const playersToUse = [...availablePlayers];
                
                playersToUse.sort((a, b) => b.rating - a.rating);

                for (let court = 0; court < courtsInUse && playersToUse.length >= 4; court++) {
                    const team1 = [];
                    const team2 = [];

                    const males = playersToUse.filter(p => p.gender === 'male');
                    const females = playersToUse.filter(p => p.gender === 'female');

                    if (males.length >= 2 && females.length >= 2) {
                        team1.push(males.shift(), females.shift());
                        team2.push(males.shift(), females.shift());
                    } else if (playersToUse.length >= 4) {
                        team1.push(playersToUse.shift(), playersToUse.pop());
                        team2.push(playersToUse.shift(), playersToUse.pop());
                    }

                    if (team1.length === 2 && team2.length === 2) {
                        const newGame = {
                            id: Date.now() + court,
                            court: court + 1,
                            players: [...team1, ...team2],
                            team1: team1,
                            team2: team2,
                            startTime: new Date(),
                            status: 'playing',
                            score: { team1: 0, team2: 0 },
                            shuttlesUsed: 0,
                            clubNightId: currentClubNight.id
                        };
                        pairings.push(newGame);
                    }
                }

                setActiveGames([...activeGames, ...pairings]);
            };

            const finishGame = (gameId, team1Score, team2Score, shuttlesUsed) => {
                const game = activeGames.find(g => g.id === gameId);
                if (!game) return;

                const finishedGame = {
                    ...game,
                    score: { team1: team1Score, team2: team2Score },
                    shuttlesUsed: shuttlesUsed || 0,
                    endTime: new Date(),
                    status: 'finished',
                    clubNightId: currentClubNight?.id
                };

                const updatedPlayers = players.map(player => {
                    const playerInGame = game.players.find(p => p.id === player.id);
                    if (playerInGame) {
                        const isTeam1 = game.team1.some(p => p.id === player.id);
                        const won = (isTeam1 && team1Score > team2Score) || (!isTeam1 && team2Score > team1Score);
                        
                        const ratingChange = won ? 25 : -15;
                        
                        return {
                            ...player,
                            gamesPlayed: player.gamesPlayed + 1,
                            wins: won ? player.wins + 1 : player.wins,
                            rating: Math.max(1000, player.rating + ratingChange)
                        };
                    }
                    return player;
                });

                setPlayers(updatedPlayers);
                setGameHistory([...gameHistory, finishedGame]);
                setActiveGames(activeGames.filter(g => g.id !== gameId));
            };

            const getWaitingPlayers = () => {
                if (!currentClubNight) return [];
                return players.filter(p => 
                    attendingPlayers.includes(p.id) &&
                    !activeGames.some(game => 
                        game.players.some(player => player.id === p.id)
                    )
                );
            };

            const getTopPlayers = () => {
                return [...players]
                    .filter(p => p.gamesPlayed > 0)
                    .sort((a, b) => b.rating - a.rating)
                    .slice(0, 5);
            };

            // Game Card Component
            const GameCard = ({ game, onFinish }) => {
                const [team1Score, setTeam1Score] = React.useState(0);
                const [team2Score, setTeam2Score] = React.useState(0);
                const [shuttlesUsed, setShuttlesUsed] = React.useState(1);

                return (
                    <div className="bg-gradient-to-br from-green-50 to-blue-50 p-4 rounded-lg border border-green-200">
                        <div className="flex justify-between items-center mb-3">
                            <h4 className="font-semibold text-gray-800">Court {game.court}</h4>
                            <span className="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">
                                Playing
                            </span>
                        </div>
                        
                        <div className="space-y-3">
                            <div className="flex justify-between items-center">
                                <div className="text-sm">
                                    <p className="font-medium text-gray-800">Team 1</p>
                                    <p className="text-gray-600">
                                        {game.team1.map(p => p.name).join(' & ')}
                                    </p>
                                </div>
                                <input
                                    type="number"
                                    min="0"
                                    value={team1Score}
                                    onChange={(e) => setTeam1Score(Number(e.target.value))}
                                    className="w-16 px-2 py-1 border border-gray-300 rounded text-center"
                                />
                            </div>
                            
                            <div className="flex justify-between items-center">
                                <div className="text-sm">
                                    <p className="font-medium text-gray-800">Team 2</p>
                                    <p className="text-gray-600">
                                        {game.team2.map(p => p.name).join(' & ')}
                                    </p>
                                </div>
                                <input
                                    type="number"
                                    min="0"
                                    value={team2Score}
                                    onChange={(e) => setTeam2Score(Number(e.target.value))}
                                    className="w-16 px-2 py-1 border border-gray-300 rounded text-center"
                                />
                            </div>

                            <div className="flex justify-between items-center bg-yellow-50 p-2 rounded border border-yellow-200">
                                <div className="text-sm">
                                    <p className="font-medium text-gray-800">🏸 Shuttles Used</p>
                                    <p className="text-xs text-gray-600">Count shuttlecocks used this game</p>
                                </div>
                                <input
                                    type="number"
                                    min="0"
                                    value={shuttlesUsed}
                                    onChange={(e) => setShuttlesUsed(Number(e.target.value))}
                                    className="w-16 px-2 py-1 border border-yellow-300 rounded text-center bg-white"
                                />
                            </div>
                        </div>
                        
                        <button
                            onClick={() => onFinish(game.id, team1Score, team2Score, shuttlesUsed)}
                            className="w-full mt-3 px-3 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 transition-all duration-200 text-sm"
                        >
                            Finish Game
                        </button>
                    </div>
                );
            };

            // Render functions
            const renderDashboard = () => (
                <div className="space-y-6">
                    {/* Club Night Status */}
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            🕐 Club Night Status
                        </h3>
                        
                        {!currentClubNight ? (
                            <div className="text-center py-8">
                                <p className="text-gray-600 mb-4">No active club night session</p>
                                <button
                                    onClick={startNewClubNight}
                                    className="px-6 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg font-medium hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-sm"
                                >
                                    Start New Club Night
                                </button>
                            </div>
                        ) : (
                            <div className="space-y-4">
                                <div className="flex justify-between items-center">
                                    <div>
                                        <p className="text-sm text-gray-600">Current Session</p>
                                        <p className="text-xl font-bold text-green-600">
                                            {new Date(currentClubNight.date).toLocaleDateString('en-GB', { 
                                                weekday: 'long', 
                                                year: 'numeric', 
                                                month: 'long', 
                                                day: 'numeric' 
                                            })}
                                        </p>
                                    </div>
                                    <div className="flex space-x-3">
                                        <button
                                            onClick={() => setCurrentView('attendance')}
                                            className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors"
                                        >
                                            Manage Attendance
                                        </button>
                                        <button
                                            onClick={finishClubNight}
                                            className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors"
                                        >
                                            End Club Night
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="grid grid-cols-4 gap-4 text-center">
                                    <div className="bg-blue-50 p-3 rounded-lg">
                                        <p className="text-2xl font-bold text-blue-600">{attendingPlayers.length}</p>
                                        <p className="text-sm text-blue-600">Players Tonight</p>
                                    </div>
                                    <div className="bg-green-50 p-3 rounded-lg">
                                        <p className="text-2xl font-bold text-green-600">{activeGames.length}</p>
                                        <p className="text-sm text-green-600">Active Games</p>
                                    </div>
                                    <div className="bg-purple-50 p-3 rounded-lg">
                                        <p className="text-2xl font-bold text-purple-600">
                                            {gameHistory.filter(g => g.clubNightId === currentClubNight.id).length}
                                        </p>
                                        <p className="text-sm text-purple-600">Games Completed</p>
                                    </div>
                                    <div className="bg-yellow-50 p-3 rounded-lg">
                                        <p className="text-2xl font-bold text-yellow-600">
                                            {gameHistory
                                                .filter(g => g.clubNightId === currentClubNight.id)
                                                .reduce((total, game) => total + (game.shuttlesUsed || 0), 0)}
                                        </p>
                                        <p className="text-sm text-yellow-600">🏸 Shuttles Used</p>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    {currentClubNight && (
                        <>
                            {/* Court Settings */}
                            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                    ⚙️ Court Configuration
                                </h3>
                                <div className="flex items-center space-x-4">
                                    <label className="text-sm font-medium text-gray-700">Courts in use tonight:</label>
                                    <select 
                                        value={courtsInUse} 
                                        onChange={(e) => setCourtsInUse(Number(e.target.value))}
                                        className="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    >
                                        <option value={1}>1 Court</option>
                                        <option value={2}>2 Courts</option>
                                        <option value={3}>3 Courts</option>
                                        <option value={4}>4 Courts</option>
                                    </select>
                                    <button 
                                        onClick={generateBalancedPairings}
                                        disabled={getWaitingPlayers().length < 4}
                                        className="px-6 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg font-medium hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-sm"
                                    >
                                        Generate New Games
                                    </button>
                                </div>
                            </div>

                            {/* Active Games */}
                            {activeGames.length > 0 && (
                                <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                    <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                        ▶️ Games in Progress
                                    </h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        {activeGames.map(game => (
                                            <GameCard key={game.id} game={game} onFinish={finishGame} />
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* Waiting Players */}
                            {getWaitingPlayers().length > 0 && (
                                <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                                    <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                        🕐 Players Waiting ({getWaitingPlayers().length})
                                    </h3>
                                    <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3">
                                        {getWaitingPlayers().map(player => (
                                            <div key={player.id} className="bg-gray-50 p-3 rounded-lg text-center border border-gray-200">
                                                <p className="font-medium text-gray-800 text-sm">{player.name}</p>
                                                <p className="text-xs text-gray-600">Rating: {player.rating}</p>
                                                <div className="flex justify-center mt-1">
                                                    <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                                                        player.gender === 'male' ? 'bg-blue-100 text-blue-800' : 'bg-pink-100 text-pink-800'
                                                    }`}>
                                                        {player.gender === 'male' ? '♂' : '♀'}
                                                    </span>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </>
                    )}

                    {/* Top Players */}
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            👑 Club Rankings
                        </h3>
                        <div className="space-y-3">
                            {getTopPlayers().map((player, index) => (
                                <div key={player.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200">
                                    <div className="flex items-center space-x-3">
                                        <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ${
                                            index === 0 ? 'bg-yellow-500' : index === 1 ? 'bg-gray-400' : index === 2 ? 'bg-amber-600' : 'bg-gray-300'
                                        }`}>
                                            {index + 1}
                                        </div>
                                        <div>
                                            <p className="font-medium text-gray-800">{player.name}</p>
                                            <p className="text-sm text-gray-600">{player.wins}/{player.gamesPlayed} wins</p>
                                        </div>
                                    </div>
                                    <div className="text-right">
                                        <p className="font-bold text-gray-800">{player.rating}</p>
                                        <p className="text-xs text-gray-600">rating</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Club Night History */}
                    {clubNights.length > 0 && (
                        <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                            <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                                📈 Recent Club Nights
                            </h3>
                            <div className="space-y-3">
                                {clubNights.slice().reverse().map(night => (
                                    <div key={night.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200">
                                        <div>
                                            <p className="font-medium text-gray-800">
                                                {new Date(night.date).toLocaleDateString('en-GB', { 
                                                    weekday: 'long', 
                                                    month: 'short', 
                                                    day: 'numeric' 
                                                })}
                                            </p>
                                            <p className="text-sm text-gray-600">{night.attendees?.length || 0} players, {night.totalGames} games, {night.totalShuttles || 0} shuttles</p>
                                        </div>
                                        <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                                            night.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'
                                        }`}>
                                            {night.status}
                                        </span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            );

            const renderAttendance = () => (
                <div className="space-y-6">
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            👥 Tonight's Attendance - {new Date(currentClubNight?.date).toLocaleDateString('en-GB', { 
                                weekday: 'long', 
                                month: 'long', 
                                day: 'numeric' 
                            })}
                        </h3>
                        
                        <div className="mb-6">
                            <p className="text-sm text-gray-600 mb-4">
                                Select players who are attending tonight's session. Only selected players will be available for game pairing.
                            </p>
                            <div className="text-center mb-4">
                                <span className="text-2xl font-bold text-blue-600">{attendingPlayers.length}</span>
                                <span className="text-gray-600 ml-2">players attending tonight</span>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            {players.map(player => (
                                <div 
                                    key={player.id} 
                                    className={`p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 ${
                                        attendingPlayers.includes(player.id)
                                            ? 'border-green-400 bg-green-50 shadow-md'
                                            : 'border-gray-200 bg-gray-50 hover:border-gray-300'
                                    }`}
                                    onClick={() => togglePlayerAttendance(player.id)}
                                >
                                    <div className="flex justify-between items-start mb-2">
                                        <h4 className="font-medium text-gray-800">{player.name}</h4>
                                        <div className="flex items-center space-x-2">
                                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                                                player.gender === 'male' ? 'bg-blue-100 text-blue-800' : 'bg-pink-100 text-pink-800'
                                            }`}>
                                                {player.gender === 'male' ? '♂' : '♀'}
                                            </span>
                                            {attendingPlayers.includes(player.id) && (
                                                <div className="w-5 h-5 bg-green-500 rounded-full flex items-center justify-center">
                                                    <span className="text-white text-xs">✓</span>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                    <div className="space-y-1 text-sm text-gray-600">
                                        <p>Rating: <span className="font-medium text-gray-800">{player.rating}</span></p>
                                        <p>Games: {player.gamesPlayed}</p>
                                        <p>Win Rate: {player.gamesPlayed > 0 ? Math.round((player.wins / player.gamesPlayed) * 100) : 0}%</p>
                                    </div>
                                </div>
                            ))}
                        </div>

                        <div className="mt-6 flex justify-center">
                            <button
                                onClick={() => setCurrentView('dashboard')}
                                className="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors"
                            >
                                Back to Dashboard
                            </button>
                        </div>
                    </div>
                </div>
            );

            const renderPlayers = () => (
                <div className="space-y-6">
                    {/* Add Player Form */}
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            ➕ Add New Player
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <input
                                type="text"
                                placeholder="Player name"
                                value={newPlayer.name}
                                onChange={(e) => setNewPlayer({...newPlayer, name: e.target.value})}
                                className="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            />
                            <select
                                value={newPlayer.gender}
                                onChange={(e) => setNewPlayer({...newPlayer, gender: e.target.value})}
                                className="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            >
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                            <select
                                value={newPlayer.skillLevel}
                                onChange={(e) => setNewPlayer({...newPlayer, skillLevel: Number(e.target.value)})}
                                className="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            >
                                {[1,2,3,4,5,6,7,8,9,10].map(level => (
                                    <option key={level} value={level}>Skill Level {level}</option>
                                ))}
                            </select>
                            <button
                                onClick={addPlayer}
                                className="px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg font-medium hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-sm"
                            >
                                Add Player
                            </button>
                        </div>
                    </div>

                    {/* Players List */}
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                        <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            👥 All Players ({players.length})
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            {players.map(player => (
                                <div key={player.id} className="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                    <div className="flex justify-between items-start mb-2">
                                        <h4 className="font-medium text-gray-800">{player.name}</h4>
                                        <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                                            player.gender === 'male' ? 'bg-blue-100 text-blue-800' : 'bg-pink-100 text-pink-800'
                                        }`}>
                                            {player.gender === 'male' ? '♂' : '♀'}
                                        </span>
                                    </div>
                                    <div className="space-y-1 text-sm text-gray-600">
                                        <p>Rating: <span className="font-medium text-gray-800">{player.rating}</span></p>
                                        <p>Games: {player.gamesPlayed}</p>
                                        <p>Win Rate: {player.gamesPlayed > 0 ? Math.round((player.wins / player.gamesPlayed) * 100) : 0}%</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50">
                    <div className="max-w-7xl mx-auto px-4 py-6">
                        {/* PWA Install Banner */}
                        {showInstallPrompt && (
                            <div className="bg-blue-600 text-white p-4 rounded-xl shadow-sm border border-blue-500 mb-6">
                                <div className="flex justify-between items-center">
                                    <div>
                                        <h3 className="font-semibold">📱 Install Badminton Club Manager</h3>
                                        <p className="text-sm text-blue-100">Install this app on your device for easier access and offline use</p>
                                    </div>
                                    <div className="flex space-x-2">
                                        <button
                                            onClick={handleInstallClick}
                                            className="px-4 py-2 bg-white text-blue-600 rounded-lg font-medium hover:bg-blue-50 transition-colors"
                                        >
                                            Install
                                        </button>
                                        <button
                                            onClick={() => setShowInstallPrompt(false)}
                                            className="px-4 py-2 border border-blue-300 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                        >
                                            Later
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Header */}
                        <div className="bg-white rounded-xl shadow-sm border border-gray-200 mb-6">
                            <div className="px-6 py-4">
                                <div className="flex justify-between items-center">
                                    <div>
                                        <h1 className="text-3xl font-bold text-gray-800 flex items-center">
                                            🏆 Badminton Club Manager
                                        </h1>
                                        <p className="text-gray-600 mt-1">Smart game pairing and player management</p>
                                    </div>
                                    
                                    {showInstallPrompt && (
                                        <button
                                            onClick={handleInstallClick}
                                            className="flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors shadow-sm"
                                        >
                                            📱 Install App
                                        </button>
                                    )}
                                </div>
                            </div>
                            
                            {/* Navigation */}
                            <div className="border-t border-gray-200 px-6">
                                <nav className="flex space-x-6">
                                    <button
                                        onClick={() => setCurrentView('dashboard')}
                                        className={`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${
                                            currentView === 'dashboard'
                                                ? 'border-blue-500 text-blue-600'
                                                : 'border-transparent text-gray-500 hover:text-gray-700'
                                        }`}
                                    >
                                        📊 Dashboard
                                    </button>
                                    <button
                                        onClick={() => setCurrentView('players')}
                                        className={`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${
                                            currentView === 'players'
                                                ? 'border-blue-500 text-blue-600'
                                                : 'border-transparent text-gray-500 hover:text-gray-700'
                                        }`}
                                    >
                                        👥 Players
                                    </button>
                                </nav>
                            </div>
                        </div>

                        {/* Main Content */}
                        {currentView === 'dashboard' ? renderDashboard() : 
                         currentView === 'players' ? renderPlayers() : 
                         renderAttendance()}
                    </div>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<BadmintonClubManager />, document.getElementById('root'));
    </script>
</body>
</html>
